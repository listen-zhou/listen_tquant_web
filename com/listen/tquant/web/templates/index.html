<!DOCTYPE html>
<html>
<head>
    <title>值得买？</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="{{ static_url('css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ static_url('css/bootstrap-datetimepicker.min.css') }}">
    <link rel="stylesheet" href="{{ static_url('css/signin.css') }}">

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="{{ static_url('js/jquery.min.js') }}"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="{{ static_url('js/bootstrap.min.js') }}"></script>
    <script src="{{ static_url('js/bootstrap.min.js') }}"></script>
    <script src="{{ static_url('js/moment-with-locales.min.js') }}"></script>
    <script src="{{ static_url('js/bootstrap-datetimepicker.min.js') }}"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js"></script>
    <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="{{ static_url('js/tquant_utils.js') }}"></script>
    <script type="text/javascript">
        var ws
        $(function(){
            ws = new WebSocket("ws://localhost:8000/average_line/ws");
            ws.onmessage = function(e){
                $("#table").html(e.data);
            }
            ws.onopen = function(){
                ws.send('hello');
                console.log('redis client hello')
            }
        });

        function duang(){
            var security_code = $('#security_code').val()
            var start_date = $('#start_date').val();
            var end_date = $('#end_date').val();
            console.log(security_code);
            console.log(start_date);
            console.log(end_date);
            var url = "/average_line";
            $.ajax({
                url: url,
                type: 'post',
                data: {
                    'security_code': security_code,
                    'start_date': start_date,
                    'end_date': end_date
                },
                dataType: 'text',
                success: function(data){
                    $('#table').html('')
                    if(data != ''){
                        $('#table').append(data);
                    }
                    else{
                        $('#table').append('没有数据');
                    }
                }
            });
        }
    </script>

    <style type="text/css">
        .m3{
            background: #FF0000;
            color: #FFFF00;
        }
        .m2{
            background: #FF3300;
            color: #FFFF00;
        }
        .m1{
            background: #FF6600;
            color: #FFFF00;
        }
        .m0{
            color: #FF0000;
        }

        .l0{
            color: #00FF00;
        }
        .l1{
            background: #00FF66;
            color: #FFFF00;
        }
        .l2{
            background: #00FF33;
            color: #FFFF00;
        }
        .l3{
            background: #00FF00;
            color: #FFFF00;
        }
        .table{
            font-size: 3px;
        }

    </style>
</head>
    <body>
        <div id="table">

        </div>
    </body>

</html>